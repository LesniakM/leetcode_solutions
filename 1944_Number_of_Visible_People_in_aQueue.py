"""

There are n people standing in a queue, and they numbered from 0 to n - 1 in left to right order.
You are given an array heights of distinct integers where heights[i] represents the height of the ith person.

A person can see another person to their right in the queue if everybody in between is shorter than both of them.
More formally, the ith person can see the jth person if i < j
and min(heights[i], heights[j]) > max(heights[i+1], heights[i+2], ..., heights[j-1]).

Return an array answer of length n where answer[i] is the number of
people the ith person can see to their right in the queue.



Example 1:


Input: heights = [10,6,8,5,11,9]
Output: [3,1,2,1,1,0]
Explanation:
Person 0 can see person 1, 2, and 4.
Person 1 can see person 2.
Person 2 can see person 3 and 4.
Person 3 can see person 4.
Person 4 can see person 5.
Person 5 can see no one since nobody is to the right of them.
"""
from timeit import timeit
from copy import deepcopy


class Solution:
    def canSeePersonsCount(self, heights: list[int]) -> list[int]:
        visibility = []

        for person_index in range(len(heights)):
            this_person_height = heights[person_index]
            last_person_height = 0
            visible_persons = 0
            for right_person_height in heights[person_index + 1:]:
                if this_person_height <= last_person_height:
                    break
                elif last_person_height < right_person_height:
                    visible_persons += 1
                    last_person_height = right_person_height
            visibility.append(visible_persons)
        return visibility

    def canSeePersonsCount2(self, heights: list[int]) -> list[int]:
        visibility = []
        while heights:
            this_person_height = heights.pop(0)
            last_person_height = 0
            visible_persons = 0
            for right_person_height in heights:
                if this_person_height <= last_person_height:
                    break
                elif last_person_height < right_person_height:
                    visible_persons += 1
                    last_person_height = right_person_height
            visibility.append(visible_persons)
        return visibility

# actually good one, but not mine. Have to analyze it.
    def canSeePersonsCount3(self, heights: list[int]) -> list[int]:
        stack, res = [], []
        for h in heights[::-1]:
            cnt = 0
            while stack:
                cnt += 1
                if h < stack[-1]:
                    break
                stack.pop()
            stack.append(h)
            res.append(cnt)
        return res[::-1]


solver = Solution()

input_list = [10, 6, 8, 5, 11, 9]
out_list = [3, 1, 2, 1, 1, 0]

assert solver.canSeePersonsCount(input_list) == out_list
assert solver.canSeePersonsCount2(deepcopy(input_list)) == out_list
assert solver.canSeePersonsCount3(input_list) == out_list
bench_iters = 25

bench_input = [99999, 99997, 99995, 99993, 99991, 99989, 99987, 99985, 99983, 99981, 99979, 99977, 99975, 99973, 99971,
               99969, 99967, 99965, 99963, 99961, 99959, 99957, 99955, 99953, 99951, 99949, 99947, 99945, 99943, 99941,
               99939, 99937, 99935, 99933, 99931, 99929, 99927, 99925, 99923, 99921, 99919, 99917, 99915, 99913, 99911,
               99909, 99907, 99905, 99903, 99901, 99899, 99897, 99895, 99893, 99891, 99889, 99887, 99885, 99883, 99881,
               99879, 99877, 99875, 99873, 99871, 99869, 99867, 99865, 99863, 99861, 99859, 99857, 99855, 99853, 99851,
               99849, 99847, 99845, 99843, 99841, 99839, 99837, 99835, 99833, 99831, 99829, 99827, 99825, 99823, 99821,
               99819, 99817, 99815, 99813, 99811, 99809, 99807, 99805, 99803, 99801, 99799, 99797, 99795, 99793, 99791,
               99789, 99787, 99785, 99783, 99781, 99779, 99777, 99775, 99773, 99771, 99769, 99767, 99765, 99763, 99761,
               99759, 99757, 99755, 99753, 99751, 99749, 99747, 99745, 99743, 99741, 99739, 99737, 99735, 99733, 99731,
               99729, 99727, 99725, 99723, 99721, 99719, 99717, 99715, 99713, 99711, 99709, 99707, 99705, 99703, 99701,
               99699, 99697, 99695, 99693, 99691, 99689, 99687, 99685, 99683, 99681, 99679, 99677, 99675, 99673, 99671,
               99669, 99667, 99665, 99663, 99661, 99659, 99657, 99655, 99653, 99651, 99649, 99647, 99645, 99643, 99641,
               99639, 99637, 99635, 99633, 99631, 99629, 99627, 99625, 99623, 99621, 99619, 99617, 99615, 99613, 99611,
               99609, 99607, 99605, 99603, 99601, 99599, 99597, 99595, 99593, 99591, 99589, 99587, 99585, 99583, 99581,
               99579, 99577, 99575, 99573, 99571, 99569, 99567, 99565, 99563, 99561, 99559, 99557, 99555, 99553, 99551,
               99549, 99547, 99545, 99543, 99541, 99539, 99537, 99535, 99533, 99531, 99529, 99527, 99525, 99523, 99521,
               99519, 99517, 99515, 99513, 99511, 99509, 99507, 99505, 99503, 99501, 99499, 99497, 99495, 99493, 99491,
               99489, 99487, 99485, 99483, 99481, 99479, 99477, 99475, 99473, 99471, 99469, 99467, 99465, 99463, 99461,
               99459, 99457, 99455, 99453, 99451, 99449, 99447, 99445, 99443, 99441, 99439, 99437, 99435, 99433, 99431,
               99429, 99427, 99425, 99423, 99421, 99419, 99417, 99415, 99413, 99411, 99409, 99407, 99405, 99403, 99401,
               99399, 99397, 99395, 99393, 99391, 99389, 99387, 99385, 99383, 99381, 99379, 99377, 99375, 99373, 99371,
               99369, 99367, 99365, 99363, 99361, 99359, 99357, 99355, 99353, 99351, 99349, 99347, 99345, 99343, 99341,
               99339, 99337, 99335, 99333, 99331, 99329, 99327, 99325, 99323, 99321, 99319, 99317, 99315, 99313, 99311,
               99309, 99307, 99305, 99303, 99301, 99299, 99297, 99295, 99293, 99291, 99289, 99287, 99285, 99283, 99281,
               99279, 99277, 99275, 99273, 99271, 99269, 99267, 99265, 99263, 99261, 99259, 99257, 99255, 99253, 99251,
               99249, 99247, 99245, 99243, 99241, 99239, 99237, 99235, 99233, 99231, 99229, 99227, 99225, 99223, 99221,
               99219, 99217, 99215, 99213, 99211, 99209, 99207, 99205, 99203, 99201, 99199, 99197, 99195, 99193, 99191,
               99189, 99187, 99185, 99183, 99181, 99179, 99177, 99175, 99173, 99171, 99169, 99167, 99165, 99163, 99161,
               99159, 99157, 99155, 99153, 99151, 99149, 99147, 99145, 99143, 99141, 99139, 99137, 99135, 99133, 99131,
               99129, 99127, 99125, 99123, 99121, 99119, 99117, 99115, 99113, 99111, 99109, 99107, 99105, 99103, 99101,
               99099, 99097, 99095, 99093, 99091, 99089, 99087, 99085, 99083, 99081, 99079, 99077, 99075, 99073, 99071,
               99069, 99067, 99065, 99063, 99061, 99059, 99057, 99055, 99053, 99051, 99049, 99047, 99045, 99043, 99041,
               99039, 99037, 99035, 99033, 99031, 99029, 99027, 99025, 99023, 99021, 99019, 99017, 99015, 99013, 99011,
               99009, 99007, 99005, 99003, 99001, 98999, 98997, 98995, 98993, 98991, 98989, 98987, 98985, 98983, 98981,
               98979, 98977, 98975, 98973, 98971, 98969, 98967, 98965, 98963, 98961, 98959, 98957, 98955, 98953, 98951,
               98949, 98947, 98945, 98943, 98941, 98939, 98937, 98935, 98933, 98931, 98929, 98927, 98925, 98923, 98921,
               98919, 98917, 98915, 98913, 98911, 98909, 98907, 98905, 98903, 98901, 98899, 98897, 98895, 98893, 98891,
               98889, 98887, 98885, 98883, 98881, 98879, 98877, 98875, 98873, 98871, 98869, 98867, 98865, 98863, 98861,
               98859, 98857, 98855, 98853, 98851, 98849, 98847, 98845, 98843, 98841, 98839, 98837, 98835, 98833, 98831,
               98829, 98827, 98825, 98823, 98821, 98819, 98817, 98815, 98813, 98811, 98809, 98807, 98805, 98803, 98801,
               98799, 98797, 98795, 98793, 98791, 98789, 98787, 98785, 98783, 98781, 98779, 98777, 98775, 98773, 98771,
               98769, 98767, 98765, 98763, 98761, 98759, 98757, 98755, 98753, 98751, 98749, 98747, 98745, 98743, 98741,
               98739, 98737, 98735, 98733, 98731, 98729, 98727, 98725, 98723, 98721, 98719, 98717, 98715, 98713, 98711,
               98709, 98707, 98705, 98703, 98701, 98699, 98697, 98695, 98693, 98691, 98689, 98687, 98685, 98683, 98681,
               98679, 98677, 98675, 98673, 98671, 98669, 98667, 98665, 98663, 98661, 98659, 98657, 98655, 98653, 98651,
               98649, 98647, 98645, 98643, 98641, 98639, 98637, 98635, 98633, 98631, 98629, 98627, 98625, 98623, 98621,
               98619, 98617, 98615, 98613, 98611, 98609, 98607, 98605, 98603, 98601, 98599, 98597, 98595, 98593, 98591,
               98589, 98587, 98585, 98583, 98581, 98579, 98577, 98575, 98573, 98571, 98569, 98567, 98565, 98563, 98561,
               98559, 98557, 98555, 98553, 98551, 98549, 98547, 98545, 98543, 98541, 98539, 98537, 98535, 98533, 98531,
               98529, 98527, 98525, 98523, 98521, 98519, 98517, 98515, 98513, 98511, 98509, 98507, 98505, 98503, 98501,
               98499, 98497, 98495, 98493, 98491, 98489, 98487, 98485, 98483, 98481, 98479, 98477, 98475, 98473, 98471,
               98469, 98467, 98465, 98463, 98461, 98459, 98457, 98455, 98453, 98451, 98449, 98447, 98445, 98443, 98441,
               98439, 98437, 98435, 98433, 98431, 98429, 98427, 98425, 98423, 98421, 98419, 98417, 98415, 98413, 98411,
               98409, 98407, 98405, 98403, 98401, 98399, 98397, 98395, 98393, 98391, 98389, 98387, 98385, 98383, 98381,
               98379, 98377, 98375, 98373, 98371, 98369, 98367, 98365, 98363, 98361, 98359, 98357, 98355, 98353, 98351,
               98349, 98347, 98345, 98343, 98341, 98339, 98337, 98335, 98333, 98331, 98329, 98327, 98325, 98323, 98321,
               98319, 98317, 98315, 98313, 98311, 98309, 98307, 98305, 98303, 98301, 98299, 98297, 98295, 98293, 98291,
               98289, 98287, 98285, 98283, 98281, 98279, 98277, 98275, 98273, 98271, 98269, 98267, 98265, 98263, 98261,
               98259, 98257, 98255, 98253, 98251, 98249, 98247, 98245, 98243, 98241, 98239, 98237, 98235, 98233, 98231,
               98229, 98227, 98225, 98223, 98221, 98219, 98217, 98215, 98213, 98211, 98209, 98207, 98205, 98203, 98201,
               98199, 98197, 98195, 98193, 98191, 98189, 98187, 98185, 98183, 98181, 98179, 98177, 98175, 98173, 98171,
               98169, 98167, 98165, 98163, 98161, 98159, 98157, 98155, 98153, 98151, 98149, 98147, 98145, 98143, 98141,
               98139, 98137, 98135, 98133, 98131, 98129, 98127, 98125, 98123, 98121, 98119, 98117, 98115, 98113, 98111,
               98109, 98107, 98105, 98103, 98101, 98099, 98097, 98095, 98093, 98091, 98089, 98087, 98085, 98083, 98081,
               98079, 98077, 98075, 98073, 98071, 98069, 98067, 98065, 98063, 98061, 98059, 98057, 98055, 98053, 98051,
               98049, 98047, 98045, 98043, 98041, 98039, 98037, 98035, 98033, 98031, 98029, 98027, 98025, 98023, 98021,
               98019, 98017, 98015, 98013, 98011, 98009, 98007, 98005, 98003, 98001, 97999, 97997, 97995, 97993, 97991,
               97989, 97987, 97985, 97983, 97981, 97979, 97977, 97975, 97973, 97971, 97969, 97967, 97965, 97963, 97961,
               97959, 97957, 97955, 97953, 97951, 97949, 97947, 97945, 97943, 97941, 97939, 97937, 97935, 97933, 97931,
               97929, 97927, 97925, 97923, 97921, 97919, 97917, 97915, 97913, 97911, 97909, 97907, 97905, 97903, 97901,
               98454, 98456, 98458, 98460, 98462, 98464, 98466, 98468, 98470, 98472, 98474, 98476, 98478, 98480, 98482,
               98484, 98486, 98488, 98490, 98492, 98494, 98496, 98498, 98500, 98502, 98504, 98506, 98508, 98510, 98512,
               98514, 98516, 98518, 98520, 98522, 98524, 98526, 98528, 98530, 98532, 98534, 98536, 98538, 98540, 98542,
               98544, 98546, 98548, 98550, 98552, 98554, 98556, 98558, 98560, 98562, 98564, 98566, 98568, 98570, 98572,
               98574, 98576, 98578, 98580, 98582, 98584, 98586, 98588, 98590, 98592, 98594, 98596, 98598, 98600, 98602,
               98604, 98606, 98608, 98610, 98612, 98614, 98616, 98618, 98620, 98622, 98624, 98626, 98628, 98630, 98632,
               98634, 98636, 98638, 98640, 98642, 98644, 98646, 98648, 98650, 98652, 98654, 98656, 98658, 98660, 98662,
               98664, 98666, 98668, 98670, 98672, 98674, 98676, 98678, 98680, 98682, 98684, 98686, 98688, 98690, 98692,
               98694, 98696, 98698, 98700, 98702, 98704, 98706, 98708, 98710, 98712, 98714, 98716, 98718, 98720, 98722,
               98724, 98726, 98728, 98730, 98732, 98734, 98736, 98738, 98740, 98742, 98744, 98746, 98748, 98750, 98752,
               98754, 98756, 98758, 98760, 98762, 98764, 98766, 98768, 98770, 98772, 98774, 98776, 98778, 98780, 98782,
               98784, 98786, 98788, 98790, 98792, 98794, 98796, 98798, 98800, 98802, 98804, 98806, 98808, 98810, 98812,
               98814, 98816, 98818, 98820, 98822, 98824, 98826, 98828, 98830, 98832, 98834, 98836, 98838, 98840, 98842,
               98844, 98846, 98848, 98850, 98852, 98854, 98856, 98858, 98860, 98862, 98864, 98866, 98868, 98870, 98872,
               98874, 98876, 98878, 98880, 98882, 98884, 98886, 98888, 98890, 98892, 98894, 98896, 98898, 98900, 98902,
               98904, 98906, 98908, 98910, 98912, 98914, 98916, 98918, 98920, 98922, 98924, 98926, 98928, 98930, 98932,
               98934, 98936, 98938, 98940, 98942, 98944, 98946, 98948, 98950, 98952, 98954, 98956, 98958, 98960, 98962,
               98964, 98966, 98968, 98970, 98972, 98974, 98976, 98978, 98980, 98982, 98984, 98986, 98988, 98990, 98992,
               98994, 98996, 98998, 99000, 99002, 99004, 99006, 99008, 99010, 99012, 99014, 99016, 99018, 99020, 99022,
               99024, 99026, 99028, 99030, 99032, 99034, 99036, 99038, 99040, 99042, 99044, 99046, 99048, 99050, 99052,
               99054, 99056, 99058, 99060, 99062, 99064, 99066, 99068, 99070, 99072, 99074, 99076, 99078, 99080, 99082,
               99084, 99086, 99088, 99090, 99092, 99094, 99096, 99098, 99100, 99102, 99104, 99106, 99108, 99110, 99112,
               99114, 99116, 99118, 99120, 99122, 99124, 99126, 99128, 99130, 99132, 99134, 99136, 99138, 99140, 99142,
               99144, 99146, 99148, 99150, 99152, 99154, 99156, 99158, 99160, 99162, 99164, 99166, 99168, 99170, 99172,
               99174, 99176, 99178, 99180, 99182, 99184, 99186, 99188, 99190, 99192, 99194, 99196, 99198, 99200, 99202,
               99204, 99206, 99208, 99210, 99212, 99214, 99216, 99218, 99220, 99222, 99224, 99226, 99228, 99230, 99232,
               99234, 99236, 99238, 99240, 99242, 99244, 99246, 99248, 99250, 99252, 99254, 99256, 99258, 99260, 99262,
               99264, 99266, 99268, 99270, 99272, 99274, 99276, 99278, 99280, 99282, 99284, 99286, 99288, 99290, 99292,
               99294, 99296, 99298, 99300, 99302, 99304, 99306, 99308, 99310, 99312, 99314, 99316, 99318, 99320, 99322,
               99324, 99326, 99328, 99330, 99332, 99334, 99336, 99338, 99340, 99342, 99344, 99346, 99348, 99350, 99352,
               99354, 99356, 99358, 99360, 99362, 99364, 99366, 99368, 99370, 99372, 99374, 99376, 99378, 99380, 99382,
               99384, 99386, 99388, 99390, 99392, 99394, 99396, 99398, 99400, 99402, 99404, 99406, 99408, 99410, 99412,
               99414, 99416, 99418, 99420, 99422, 99424, 99426, 99428, 99430, 99432, 99434, 99436, 99438, 99440, 99442,
               99444, 99446, 99448, 99450, 99452, 99454, 99456, 99458, 99460, 99462, 99464, 99466, 99468, 99470, 99472,
               99474, 99476, 99478, 99480, 99482, 99484, 99486, 99488, 99490, 99492, 99494, 99496, 99498, 99500, 99502,
               99504, 99506, 99508, 99510, 99512, 99514, 99516, 99518, 99520, 99522, 99524, 99526, 99528, 99530, 99532,
               99534, 99536, 99538, 99540, 99542, 99544, 99546, 99548, 99550, 99552, 99554, 99556, 99558, 99560, 99562,
               99564, 99566, 99568, 99570, 99572, 99574, 99576, 99578, 99580, 99582, 99584, 99586, 99588, 99590, 99592,
               99594, 99596, 99598, 99600, 99602, 99604, 99606, 99608, 99610, 99612, 99614, 99616, 99618, 99620, 99622,
               99624, 99626, 99628, 99630, 99632, 99634, 99636, 99638, 99640, 99642, 99644, 99646, 99648, 99650, 99652,
               99654, 99656, 99658, 99660, 99662, 99664, 99666, 99668, 99670, 99672, 99674, 99676, 99678, 99680, 99682,
               99684, 99686, 99688, 99690, 99692, 99694, 99696, 99698, 99700, 99702, 99704, 99706, 99708, 99710, 99712,
               99714, 99716, 99718, 99720, 99722, 99724, 99726, 99728, 99730, 99732, 99734, 99736, 99738, 99740, 99742,
               99744, 99746, 99748, 99750, 99752, 99754, 99756, 99758, 99760, 99762, 99764, 99766, 99768, 99770, 99772,
               99774, 99776, 99778, 99780, 99782, 99784, 99786, 99788, 99790, 99792, 99794, 99796, 99798, 99800, 99802,
               99804, 99806, 99808, 99810, 99812, 99814, 99816, 99818, 99820, 99822, 99824, 99826, 99828, 99830, 99832,
               99834, 99836, 99838, 99840, 99842, 99844, 99846, 99848, 99850, 99852, 99854, 99856, 99858, 99860, 99862,
               99864, 99866, 99868, 99870, 99872, 99874, 99876, 99878, 99880, 99882, 99884, 99886, 99888, 99890, 99892,
               99894, 99896, 99898, 99900, 99902, 99904, 99906, 99908, 99910, 99912, 99914, 99916, 99918, 99920, 99922,
               99924, 99926, 99928, 99930, 99932, 99934, 99936, 99938, 99940, 99942, 99944, 99946, 99948, 99950, 99952,
               99954, 99956, 99958, 99960, 99962, 99964, 99966, 99968, 99970, 99972, 99974, 99976, 99978, 99980, 99982,
               99984, 99986, 99988, 99990, 99992, 99994, 99996, 99998, 100000]

print(timeit(lambda: solver.canSeePersonsCount(bench_input), number=bench_iters))
print(timeit(lambda: solver.canSeePersonsCount2(deepcopy(bench_input)), number=bench_iters))
print(timeit(lambda: solver.canSeePersonsCount3(bench_input), number=bench_iters))
